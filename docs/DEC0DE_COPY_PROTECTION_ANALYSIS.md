# DEC0DE Copy Protection Analysis Report

**Date:** 2026-01-04  
**Source:** dec0de v1.1 by Orion ^ The Replicants (Nov 2017)  
**Repository:** https://github.com/orionfuzion/dec0de  
**Analysis for:** UFT v3.6.0.017

---

## Executive Summary

DEC0DE is a comprehensive Atari ST copy protection removal tool that implements **10 different protection systems** with detailed reverse engineering. The source code provides invaluable insights into:

1. **Rob Northen CopyLock** - Series 1 (1988) and Series 2 (1989)
2. **TVD (Trace Vector Decoding)** - Anti-debugger encryption
3. **Pattern-based detection** - Sophisticated identification algorithms
4. **Encryption schemes** - XOR, ADD-based key derivation

---

## 1. Supported Protection Systems

| Protection | Version | Type | Key Feature |
|------------|---------|------|-------------|
| **Rob Northen CopyLock** | Series 1 (1988) | Disk-based | XOR-chain encryption |
| **Rob Northen CopyLock** | Series 2 (1989) | Disk-based | TVD + Magic32 |
| NTM/Cameo Toxic Packer | v1.0 | Packer | Basic encryption |
| R.AL Little Protection | v01 | Packer | Size obfuscation |
| R.AL Megaprot | v0.02 | Packer | Enhanced |
| Orion Sly Packer | v2.0 | Packer | Self-modifying |
| Cameo Cooper | v0.5, v0.6 | Packer | Multi-layer |
| Illegal Anti-bitos | v1.0-v1.61 | Packer | 4 variants |
| Zippy Little Protection | v2.05, v2.06 | Packer | Compact |
| Yoda Lock-o-matic | v1.3 | Packer | Stack tricks |
| CID Encrypter | v1.0bp | Packer | Blue Planet |

---

## 2. Rob Northen CopyLock - Series 1 (1988)

### 2.1 Encryption Scheme

```c
// Series 1 (1988) - XOR with inverted/swapped previous instruction
static uint32_t decode_robn88(uint8_t *buf) {
    uint32_t key32 = read32(buf - 4);  // Previous encrypted instruction
    key32 = ~key32;                     // Bitwise invert
    key32 = SWAP32(key32);              // Swap high/low words
    return read32(buf) ^ key32;         // XOR decrypt
}
```

### 2.2 Variants (5 total: a-e)

| Variant | Supervisor Switch | TVD Type |
|---------|-------------------|----------|
| a | ILLEGAL exception | Common |
| b | PRIV instruction 2 | Common |
| c | PRIV instruction 1 | Variant 2 |
| d | PRIV instruction 1 | Flying Shark |
| e | Binary format | Common |

---

## 3. Rob Northen CopyLock - Series 2 (1989)

### 3.1 Encryption Scheme

```c
// Series 2 (1989) - ADD-based key derivation
static uint32_t decode_robn89(uint8_t *buf, uint32_t magic32) {
    uint32_t key32 = read32(buf - 4);  // Previous encrypted instruction
    key32 += magic32;                   // ADD magic value (not XOR!)
    return read32(buf) ^ key32;         // XOR decrypt
}
```

### 3.2 Magic32 Discovery

The key to cracking Series 2 is discovering the per-protection magic value:

```c
// Search for trampoline pattern: LEA PC+$12,A6 (0x4DFA0010)
w32     = read32(buf + i);
w32    ^= 0x4DFA0010;
magic32 = w32 - read32(buf + i - 4);  // Candidate magic

// Verify with MOVE.L -4(A6),D6 (0x2C2EFFFC)
key32   = read32(buf + i + 4 - 4) + magic32;
w32     = read32(buf + i + 4) ^ key32;
if (w32 == 0x2C2EFFFC) {
    // Magic value confirmed!
}
```

### 3.3 Variants (6 total: a-f)

| Variant | Switch Mode | Init Pattern |
|---------|-------------|--------------|
| a | ILLEGAL | Init 1 |
| b | ILLEGAL | Init 2 |
| c | Direct SUP | Init 1 |
| d | Direct SUP | Init 2 |
| e | None | Init 1 |
| f | None | Init 2 |

---

## 4. Serial Key Usage Flags

```c
#define SERIAL_USAGE_DECODE_PROG   0x01  // Decrypt wrapped program
#define SERIAL_USAGE_RETURN        0x02  // Return to caller in D0
#define SERIAL_USAGE_SAVE_MEM      0x04  // Save at memory address
#define SERIAL_USAGE_MAGIC_MEM     0x08  // Convert to magic value
#define SERIAL_USAGE_EOR_MEM       0x10  // XOR with memory region
```

---

## 5. UFT Integration

### New Header Created
- `uft_atarist_copylock.h` - Complete Series 1/2 detection

### Key Functions
```c
uint32_t uft_copylock88_decode_instr(const uint8_t *buf);
uint32_t uft_copylock89_decode_instr(const uint8_t *buf, uint32_t magic32);
int32_t uft_copylock89_find_trampoline(...);
bool uft_copylock_st_detect(...);
```

---

*Generated by UFT DEC0DE Analysis Pipeline*
